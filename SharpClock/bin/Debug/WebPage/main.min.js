function pauseButton(n){$("#pauseBtn").html(n==!0?"Module auto switch<i class='material-icons right'>play_arrow<\/i>":"Module auto switch <i class='material-icons right'>pause<\/i>");n==!0?($("#pauseBtn").removeClass("green"),$("#pauseBtn").addClass("yellow darken-3")):($("#pauseBtn").removeClass("yellow darken-3"),$("#pauseBtn").addClass("green"))}function SerializeForm(n){let t=$(n).find('input:not([type="checkbox"])').serialize(),i=$(n).find('input[type="checkbox"]').map(function(){return this.name+"="+this.checked}).get().join("&");t+=i!=""&&t!=""?"&"+i:i;t=t.split("&");const r={};return t.forEach(function(n){n=n.split("=");r[n[0]]=decodeURIComponent(n[1])}),r}function mapValue(n,t,i,r,u){return Math.round((n-t)*u/i+r)}$(function(){function n(){$("#Loader").show();$.post("getModules",function(n){$("#moduleList").html("");console.log(n.Response);n.Response.forEach(function(n){let t=`<form class="noActionForm" method="POST" action="">`;t+=`<input type="hidden" name="Module" value="${n.Name}"/>`;t+=`<p><label>Module</label>`;t+=`<div class="switch"><label for="${n.Name}_Power">`;t+=`Off`;t+=`<input type="checkbox" id="${n.Name}_Power" name="Power" ${n.Status=="started"?"checked":""} />`;t+=`<span class="lever"></span>`;t+=`On`;t+=`</label></div></p><br />`;n.Values.forEach(function(i){let r=`<p>`;if(i.type=="Int32"||i.type=="float")r+=`<label for="${n.Name}_${i.Name}">`,r+=`<span>${i.Name}</span>`,r+=`<input type="number" id="${n.Name}_${i.Name}" name="${i.Name}" value="${i.Value}" />`,r+=`</label>`;else if(i.type=="Boolean")r+=`<label>${i.Name}</label>`,r+=`<div class="switch"><label for="${n.Name}_${i.Name}">`,r+=`Off`,r+=`<input type="checkbox" id="${n.Name}_${i.Name}" name="${i.Name}" ${i.Value=="True"?"checked":""} />`,r+=`<span class="lever"></span>`,r+=`On`,r+=`</label></div>`;else if(i.type=="String")r+=`<label for="${n.Name}_${i.Name}">`,r+=`<span>${i.Name}</span>`,r+=`<input type="text" id="${n.Name}_${i.Name}" name="${i.Name}" value="${i.Value}" />`,r+=`</label>`;else if(i.type=="Enum"){let t=i.options.split(",");r+=`<label>${i.Name}</label><br/>`;t.forEach(function(t){r+=`<label for="${n.Name}_${i.Name}_${t}">`;r+=`<input type="radio" id="${n.Name}_${i.Name}_${t}" name="${i.Name}" value="${t}" ${i.Value==t?`checked`:""} />`;r+=`<span>${t}</span>`;r+=`</label>`;r+=`<br />`})}else i.type=="Color"?(r+=`<label>${i.Name}</label><br/>`,r+=`<label for="${n.Name}_${i.Name}">`,r+=`<input type="color" id="${n.Name}_${i.Name}" name="${i.Name}" value="${i.Value}"/>`,r+=`</label>`,r+=`<br />`):i.type=="TimeSpan"&&(r+=`<label>${i.Name}</label><br/>`,r+=`<label for="${n.Name}_${i.Name}">`,r+=`<input type="time" id="${n.Name}_${i.Name}" name="${i.Name}" value="${i.Value}"/>`,r+=`</label>`,r+=`<br />`);r+="<\/p><br />";t+=r});t+=`<div class="right-align">`;t+=`<button type="button" class="waves-effect waves-light btn yellow darken-3" id="${n.Name}_reloadBtn"><span class="material-icons right">refresh</span></button>`;t+=`<button type="button" class="waves-effect waves-light btn green darken-3" id="${n.Name}_switchtoBtn"><span class="material-icons right">visibility</span></button>`;t+=`</div>`;t+=`</form>`;const i=`
                    <li>
                        <div class="collapsible-header">
                            <i class="material-icons">${n.Icon}</i>
                            ${n.Name}
                            <span id="${n.Name}_isRunning" class="badge ${n.Status=="started"?"green":"red"}-text"><span style="font-weight:bold" class="material-icons">power_settings_new</span></span>
                        </div>
                        <div class="collapsible-body white">
                            ${t}
                        </div>
                    </li>`;$("#moduleList").append(i);$(`#${n.Name}_reloadBtn`).click(function(){$("#Loader").show();$.post("reloadModule",{name:n.Name},function(){$("#Loader").hide()})});$(`#${n.Name}_switchtoBtn`).click(function(){$("#Loader").show();$.post("switchModule",{name:n.Name,pause:!0},function(n){n.Response.Error&&alert("Module is disabled!");pauseButton(n.Response.Pause);$("#Loader").hide()},"JSON")})});$(".fixed-action-btn").floatingActionButton({direction:"left"});$(".noActionForm").submit(function(n){n.preventDefault();$("#Loader").show();const t=SerializeForm(this);console.log(t);$.post("modifyModuleSettings",t,function(n){console.log(n);n.Response.Status?$("#"+n.Response.Name+"_isRunning").removeClass("red-text").addClass("green-text"):$("#"+n.Response.Name+"_isRunning").removeClass("green-text").addClass("red-text");$("#Loader").hide()},"JSON")});$(".noActionForm :input").change(function(n){console.log(n.target);$(this).submit()});$("#Loader").hide()},"JSON")}function t(){$("#AppInstall_Save").click(function(){$("#Loader").show();const n=$("#AppInstall_File")[0].files;if(console.log(n),n.length>0){const t=new FormData;t.append("file",n[0],n[0].name);$.ajax({type:"POST",contentType:!1,cache:!1,processData:!1,url:"AppInstall",dataType:"json",data:t}).done(n=>{console.log(n)}).always(()=>{$("#Loader").hide(),alert("Upload Complete")})}else $("#Loader").hide()})}function i(){$("#Loader").show();$.post("GetDlls",function(n){$("#InstaledDll").html("");n.Response.forEach(n=>{$("#InstaledDll").append(`<li class="collection-item"><div>${n}<a href="#!" class="secondary-content"><i class="material-icons">delete</i></a></div></li>`)});$("#Loader").hide()},"JSON")}function r(){$("#brightnessControl").mousemove(function(){const n=$(this).val();$("#brightnessValue").html(n+"%")});$.post("getProperties",function(n){const t=mapValue(n.Response.Brightness,2,32,0,100);$("#brightnessControl").val(t);$("#brightnessValue").html(t+"%");$("#brightnessControl").change(function(){$("#Loader").show();const n=mapValue($(this).val(),0,100,2,32);$.post("Brightness",{Value:n},function(){$("#Loader").hide()},"JSON")});pauseButton(n.Response.Pause)},"JSON")}console.log("ready!");r();n();t();i();M.AutoInit();$("#moduleList").sortable({axis:"y",containment:$("#moduleList").parent(),cursor:"grabbing",delay:150,stop:function(){$("#Loader").show();const n=[];$("#moduleList li").each(function(){n.push($(this).find("form").serializeArray()[0].value)});$.post("sortModules",{order:n},function(){$("#Loader").hide()});console.log(n)}});$("#moduleList").disableSelection();$("#nextModuleBtn").click(function(){$.post("nextModule",function(){},"JSON")});$("#pauseBtn").click(function(){$.post("pause",function(n){pauseButton(n.Response.Pause)},"JSON")});$("#stopBtn").click(function(){$.post("shutdown",{hard:"false"},function(){},"JSON")});$("#shutdownBtn").click(function(){$.post("shutdown",{hard:"true"},function(){},"JSON")});$("#reloadBtn").click(function(){$.post("shutdown",{hard:"restart"},function(){},"JSON")})});